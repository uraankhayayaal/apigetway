# LADR - Lightweight architectural decision record (Упрощенный реестр архитектурных решений)
- Авторизация;
- Автогенерация документации для сервисов;
- Оъединения все документаций сервисов в одну;

## Использование JWT для аутентификации
### Статус
Принято
### Контекст
В микросервисной структуре, нужно вынести аутентификацию за скобки в ApiGetway (в единую точку входа), и не реализовывать аутентификацию в каждом сервисе.
### Решение
Данный метод хорошо подходит для решения авторизации на стороне ApiGetway и может содержать промты в себе, и его легко записывать в заголовках запросов.
### Следствие
- Для регистрации и авторизации содается микросервис содержащий информацию о прользователях;
- ApiGetway проводит аутентификацию и проверки из заголвка запросов;

## Автогенерация openapi документации на основе кода
### Статус
Принято
### Контекст
Чтобы разработчики не тратили время на написание спецификации для openapi нужен генератор на основе типов запросов и ответов.
### Решение
Использование php модуля Reflection
### Следствие
- Используются все роуты из конфика Lumen;
- Для Response используется [JsonResource](vendor/illuminate/http/Resources/Json/JsonResource.php) как базовый тип;
- Для Request используется [BaseRequestData](app/Http/Requests/Base/BaseRequestData.php), [BaseRequestFormData](app/Http/Requests/Base/BaseRequestFormData.php), [BaseRequestQueryData](app/Http/Requests/Base/BaseRequestQueryData.php) как базовые типы;

## Общая документация openapi
### Статус
Принято
### Контекст
Для организации общей документации сервисов нужна автоматизированная система для сбора api документации в один endpoind. В перспективе нужно будет еще создать несколько endpoind-ов для гибкого распределения доступами в сервисы (ApiGetway для приложений, отдельно для других клиентов и др.).
### Решение
Использование объединения openapi документации.
### Следствие
- Регистрация в самом ApiGetway openapi документации от сервисов;
- Для каждого сервиса должна быть своя openapi документация;

## Идемпотентность микросервисов
### Статус
На рассмотрении
### Контекст
Подробне: https://habr.com/ru/companies/domclick/articles/779872/
### Решение
Использование uuid ключа идемпотентности для запросов;
### Следствие
- Генерация uuid ключа идемпотентности на стороне ApiGetway;
- Если нужно повторить запрос, нужно использовать тот же uuid ключ идемпотентности;
- Нужно хранить uuid ключи идемпотентности;
- Нужно хранить ответ для uuid ключи идемпотентности;
- ?Создать микросервис для хранения ключей и ответов?

## Экспоненциальная задержка
### Статус
На рассмотрении

## Тротлинг
### Статус
На рассмотрении